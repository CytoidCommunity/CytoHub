(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{BP2G:function(t,e,r){"use strict";r.r(e);var s=r("8Y7J");class a{}var i=r("pMnS"),o=r("pDJ3"),n=r("UcX6"),u=r("7WvE"),h=r("knpY"),l=r("AytR");r("/yc/");class p{constructor(t,e,r,s,a,i){this.route=t,this.title=e,this.proc=r,this.bili=s,this.http=a,this.translate=i,this.lastMessage={}}ngAfterViewInit(){this.currentRoomId=this.route.snapshot.params.id,this.translate.get("ROOM").subscribe(t=>{this.title.setTitle(t.replace("{roomId}",this.currentRoomId))}),this.route.snapshot.queryParamMap.has("loadAvatar")&&(this.proc.loadAvatar="true"===this.route.snapshot.queryParamMap.get("loadAvatar").toLowerCase()),this.route.snapshot.queryParamMap.has("levelFilter")&&(this.proc.userLevelFilter=Number(this.route.snapshot.queryParamMap.get("levelFilter"))),this.route.snapshot.queryParamMap.has("hideGiftDanmaku")&&(this.proc.hideGiftDanmaku="true"===this.route.snapshot.queryParamMap.get("hideGiftDanmaku").toLowerCase()),this.route.snapshot.queryParamMap.has("showGift")&&(this.proc.showGift="true"===this.route.snapshot.queryParamMap.get("showGift").toLowerCase()),this.route.snapshot.queryParamMap.has("giftOnly")&&(this.renderer.displayMode="true"===this.route.snapshot.queryParamMap.get("giftOnly").toLowerCase()?2:3),this.route.snapshot.queryParamMap.has("wordFilter")&&(this.proc.wordFilter=this.proc.wordFilter.concat(String(this.route.snapshot.queryParamMap.get("wordFilter")).split(","))),this.route.snapshot.queryParamMap.has("blackList")&&(this.proc.blackList=this.proc.blackList.concat(String(this.route.snapshot.queryParamMap.get("blackList")).split(",").map(t=>Number(t)))),this.route.snapshot.queryParamMap.has("groupSimilar")&&(this.renderer.groupSimilar="true"===this.route.snapshot.queryParamMap.get("groupSimilar").toLowerCase()),this.route.snapshot.queryParamMap.has("pure")&&(this.proc.pure="true"===this.route.snapshot.queryParamMap.get("pure").toLowerCase()),this.route.snapshot.queryParamMap.has("minGiftValue")&&(this.proc.minGiftValue=Number(this.route.snapshot.queryParamMap.get("minGiftValue"))),this.route.snapshot.queryParamMap.has("silverGiftRatio")&&(this.proc.silverGiftRatio=Number(this.route.snapshot.queryParamMap.get("silverGiftRatio")))}onload(){this.currentRoomId<=0?this.translate.get("IDFORMATERROR").subscribe(t=>{this.renderer.sendSystemInfo(t)}):this.proc.pure?this.start(this.currentRoomId):(this.translate.get("GETROOMINFO").subscribe(t=>{this.renderer.sendSystemInfo(t)}),this.http.get(`${l.a.api_server}/stat/${this.currentRoomId}`).subscribe(t=>{this.bili.ownerId=t.uid,t.config&&(this.proc.loadAvatar=null!=t.config.loadAvatar?t.config.loadAvatar:this.proc.loadAvatar,this.proc.userLevelFilter=t.config.levelFilter||this.proc.userLevelFilter,this.proc.hideGiftDanmaku=null!=t.config.hideGiftDanmaku?t.config.hideGiftDanmaku:this.proc.hideGiftDanmaku,this.proc.showGift=null!=t.config.showGift?t.config.showGift:this.proc.showGift,this.proc.minGiftValue=t.config.minGiftValue||this.proc.minGiftValue,this.proc.silverGiftRatio=t.config.silverGiftRatio||this.proc.silverGiftRatio,this.proc.wordFilter=this.proc.wordFilter.concat(t.config.wordFilter||[]),this.proc.blackList=this.proc.blackList.concat(t.config.blackList||[]),this.proc.customEmotions=t.config.customEmotions||[],this.proc.customGiftLevel=t.config.customGiftLevel||this.proc.customGiftLevel,this.proc.customGiftLevel.sort((t,e)=>e.value-t.value),this.renderer.displayMode=t.config.displayMode||this.renderer.displayMode,this.renderer.groupSimilar=null!=t.config.groupSimilar?t.config.groupSimilar:this.renderer.groupSimilar,this.renderer.groupSimilarWindow=t.config.groupSimilarWindow||this.renderer.groupSimilarWindow,this.renderer.maxDammakuNum=t.config.maxDammakuNumber||this.renderer.maxDammakuNum),this.start(t.room_id)},t=>{this.translate.get("ROOMINFORAWID").subscribe(t=>{this.renderer.sendSystemInfo(t)}),this.start(this.currentRoomId)}))}start(t){this.translate.get("CONNECTING").subscribe(e=>{this.renderer.sendSystemInfo(e.replace("{realRoomId}",t))}),this.bili.connect(Number(t)).subscribe(t=>{"connected"===t.type?this.translate.get("CONNECTED").subscribe(t=>{this.renderer.sendSystemInfo(t)}):("danmaku"===t.type?this.lastMessage[t.uid]={time:Date.now(),message:t}:"gift"===t.type&&!t.superchat&&null!=this.lastMessage[t.uid]&&Date.now()-this.lastMessage[t.uid].time<6e4&&(t.paid_message=this.lastMessage[t.uid].message.message,this.lastMessage[t.uid]=null),this.renderer.sendDanmaku(t))},e=>{e.target.readyState===WebSocket.CLOSED&&(this.translate.get("CONNECTCLOSED").subscribe(t=>{this.renderer.sendSystemInfo(t)}),setTimeout(()=>this.start(t),5e3))},()=>{this.translate.get("DISCONNECTED").subscribe(t=>{this.renderer.sendSystemInfo(t)}),this.start(t)})}}var c=r("iInd"),m=r("cUpR"),d=r("IheW"),f=r("TSSN"),g=s.lb({encapsulation:2,styles:[[""]],data:{}});function b(t){return s.Db(0,[s.Ab(671088640,1,{renderer:0}),(t()(),s.nb(1,0,null,null,1,"yt-live-chat-renderer",[],null,[[null,"onawake"]],(function(t,e,r){var s=!0;return"onawake"===e&&(s=!1!==t.component.onload()&&s),s}),o.b,o.a)),s.mb(2,114688,[[1,4],["renderer",4]],0,n.a,[s.z],{displayMode:[0,"displayMode"]},{onawake:"onawake"})],(function(t,e){t(e,2,0,3)}),null)}function y(t){return s.Db(0,[(t()(),s.nb(0,0,null,null,1,"app-alpha",[],null,null,null,b,g)),s.mb(1,4243456,null,0,p,[c.a,m.i,u.a,h.a,d.c,f.i],null,null)],null,null)}var M=s.jb("app-alpha",p,y,{},{},[]),w=r("SVse"),v=r("PCNd"),G=r("RdNf");class k{}r.d(e,"AlphaModuleNgFactory",(function(){return S}));var S=s.kb(a,[],(function(t){return s.wb([s.xb(512,s.j,s.W,[[8,[i.a,M]],[3,s.j],s.v]),s.xb(4608,w.l,w.k,[s.s,[2,w.z]]),s.xb(1073742336,w.b,w.b,[]),s.xb(1073742336,v.a,v.a,[]),s.xb(1073742336,G.a,G.a,[]),s.xb(1073742336,c.l,c.l,[[2,c.q],[2,c.k]]),s.xb(1073742336,k,k,[]),s.xb(1073742336,a,a,[]),s.xb(1024,c.i,(function(){return[[{path:"",component:p}]]}),[])])}))}}]);